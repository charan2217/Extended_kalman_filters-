

# 🚗 Vehicle Sensor Fusion using Extended Kalman Filter (EKF)

This project implements a **2D Extended Kalman Filter (EKF)** for real-time **vehicle localization** using data from:

* 🛰️ Noisy **GPS** (`gps_x`, `gps_y`)
* 📡 **IMU** acceleration (`imu_ax`, `imu_ay`)
* Optional 📏 **Yaw rate** & heading tracking

It includes animated path estimation using OpenCV and Matplotlib and can easily be extended for full-stack autonomous navigation.

---

## 🗂️ Project Structure

```bash
.
├── ekf_upgrade.py                  # EKF with heading and yaw rate (6D state)
├── main.py                         # Simple Kalman Filter run file
├── simulation.py                   # Simulated data EKF processing
├── sensor_data.csv                 # Basic sensor fusion dataset
├── vehicle_sensor_fusion_dataset.csv # Realistic GPS + IMU dataset
├── ekf_path_simulation.avi        # Generated EKF path animation video
├── frame.jpg                       # Temporary frame used in animation
└── README.md                       # (You're here!)
```

---

## 📌 EKF State Definition

The system tracks a 6D state vector:

```python
x = [pos_x, pos_y, vel_x, vel_y, heading, yaw_rate]
```

### Inputs:

* `u = [acc_x, acc_y]` → from IMU
* `z = [gps_x, gps_y]` → from GPS

### Prediction (Physics-based motion model):

```python
x = F @ x + B @ u
P = F @ P @ F.T + Q
```

### Correction (Sensor fusion update):

```python
K = P @ H.T @ inv(H @ P @ H.T + R)
x = x + K @ (z - H @ x)
P = (I - K @ H) @ P
```

---

## 🎥 EKF Path Visualization

The file `ekf_path_simulation.avi` is generated by:

* Plotting GPS and estimated paths frame-by-frame
* Capturing each frame as an image
* Combining all frames into a video using OpenCV

### 🔵 Blue Dots = Raw GPS

### 🔴 Red Line = Smoothed EKF Estimate

---

## 📊 Sample Input Format

**File:** `vehicle_sensor_fusion_dataset.csv`

```csv
timestamp,gps_x,gps_y,imu_ax,imu_ay
0,0.0,0.0,0.2,0.1
1,0.8,0.4,0.25,0.12
2,1.6,0.9,0.22,0.15
...
```

---

## ▶️ How to Run

### Run EKF estimation:

```bash
python main.py
```

### Run EKF with heading/yaw rate:

```bash
python ekf_upgrade.py
```

### Generate EKF animation video:

```bash
python simulation.py
```

---

## 🛠️ Requirements

Install dependencies:

```bash
pip install numpy pandas matplotlib opencv-python
```

---

## 🚀 Features

* ✅ Simple 2D Kalman Filter for position
* ✅ Extended Kalman Filter (EKF) with velocity & orientation
* ✅ Realtime animation generation with OpenCV
* ✅ Easily extensible for real-time localization and SLAM

---

## 💡 Future Ideas

* Integrate with real-time GPS modules
* Add gyroscope/yaw rate as control input
* 3D tracking with altitude (barometer)
* Integration with ROS or Carla simulator

